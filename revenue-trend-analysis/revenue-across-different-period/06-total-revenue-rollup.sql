/* Calculate grand total of all revenues annually and for each month.*/

SELECT
  	SUM(amount) AS total_revenue,
	EXTRACT(year FROM order_date) AS revenue_year,
  	EXTRACT(month FROM order_date) AS revenue_month
FROM orders
GROUP BY ROLLUP(
	EXTRACT(year FROM order_date),
  	EXTRACT(month FROM order_date)
)
ORDER BY
	EXTRACT(year FROM order_date),
  	EXTRACT(month FROM order_date);


| total_revenue | revenue_year | revenue_month |
| ------------- | ------------ | ------------- |
| 27861.90      | 2016         | 7             |
| 25485.28      | 2016         | 8             |
| 26381.40      | 2016         | 9             |
| 37515.73      | 2016         | 10            |
| 45600.05      | 2016         | 11            |
| 45239.63      | 2016         | 12            |
| 208083.99     | 2016         | null          |
| 61258.08      | 2017         | 1             |
| 38483.64      | 2017         | 2             |
| 38547.23      | 2017         | 3             |
| 53032.95      | 2017         | 4             |
| 53781.30      | 2017         | 5             |
| 36362.82      | 2017         | 6             |
| 51020.88      | 2017         | 7             |
| 47287.68      | 2017         | 8             |
| 55629.27      | 2017         | 9             |
| 66749.24      | 2017         | 10            |
| 43533.81      | 2017         | 11            |
| 71398.45      | 2017         | 12            |
| 617085.35     | 2017         | null          |
| 94222.13      | 2018         | 1             |
| 99415.29      | 2018         | 2             |
| 193637.42     | 2018         | null          |
| 365.89        | 2021         | 4             |
| 2960.30       | 2021         | 5             |
| 2678.50       | 2021         | 6             |
| 3059.65       | 2021         | 7             |
| 1451.90       | 2021         | 8             |
| 3430.25       | 2021         | 9             |
| 3508.43       | 2021         | 10            |
| 1119.50       | 2021         | 11            |
| 1100.80       | 2021         | 12            |
| 19675.22      | 2021         | null          |
| 3729.38       | 2022         | 1             |
| 4571.75       | 2022         | 2             |
| 3388.83       | 2022         | 3             |
| 7004.25       | 2022         | 4             |
| 1039.97       | 2022         | 5             |
| 6100.79       | 2022         | 6             |
| 751.40        | 2022         | 7             |
| 2543.70       | 2022         | 8             |
| 5101.00       | 2022         | 9             |
| 2958.30       | 2022         | 10            |
| 3416.86       | 2022         | 11            |
| 2065.06       | 2022         | 12            |
| 42671.29      | 2022         | null          |
| 1699.55       | 2023         | 1             |
| 9509.70       | 2023         | 2             |
| 16824.00      | 2023         | 3             |
| 13120.83      | 2023         | 4             |
| 7938.45       | 2023         | 5             |
| 7661.54       | 2023         | 6             |
| 3768.95       | 2023         | 7             |
| 5809.85       | 2023         | 8             |
| 1211.07       | 2023         | 9             |
| 8576.30       | 2023         | 10            |
| 4119.80       | 2023         | 11            |
| 9682.03       | 2023         | 12            |
| 89922.07      | 2023         | null          |
| 7014.64       | 2024         | 1             |
| 2902.00       | 2024         | 2             |
| 3266.81       | 2024         | 3             |
| 3037.73       | 2024         | 4             |
| 28430.65      | 2024         | 5             |
| 4045.90       | 2024         | 6             |
| 6201.35       | 2024         | 7             |
| 2111.10       | 2024         | 8             |
| 2828.68       | 2024         | 9             |
| 1119.60       | 2024         | 10            |
| 6419.50       | 2024         | 11            |
| 3785.00       | 2024         | 12            |
| 71162.96      | 2024         | null          |
| 2696.00       | 2025         | 1             |
| 7045.17       | 2025         | 2             |
| 3042.68       | 2025         | 3             |
| 10771.14      | 2025         | 4             |
| 23554.99      | 2025         | null          |
| 1265793.29    | null         | null          |